<%- include('parts/header') %>
<link rel='stylesheet' type='text/css' href='/styles/css/price.css'/>
</head>
 <body>
    <%- include('parts/nav') %>
    <div class="container">
        <div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
            <h3 class="display-4">Consultancy</h3>
        </div>
         <form action="/newconsultancy" method='post' novalidate>
                <div class="row">
                     <!-- First Name -->
                    <div class="input-group col-lg-6 mb-4">
                        <select id="patient" name="pid" class="form-control bg-white border-left-0 border-md">
                            <% if (Object.keys(pats).length > 0) { 
                                pats.forEach(function(p){%>
                                <option value='<%= p._id %>'><%= p.fullname %></option>
                            <%})}%>
                        </select>
                    </div>

                    <!-- Doctor -->
                    <div class="input-group col-lg-6 mb-4">
                        <div class="input-group-prepend">
                            <span class="input-group-text bg-white px-4 border-md border-right-0">
                                <i class="fa fa-stethoscope text-muted"></i>
                            </span>
                        </div>
                        <input id="doctor" type="text" name="doctor" placeholder="doctor" class="form-control bg-white border-left-0 border-md">
                    </div>

                    <!-- Date -->
                    <div class="input-group col-lg-6 mb-4">
                        <div class="input-group-prepend">
                            <span class="input-group-text bg-white px-4 border-md border-right-0">
                                <i class="fa fa-calendar text-muted"></i>
                            </span>
                        </div>
                        <input id="consultDate" type="date" name="consultDate" placeholder="Last Name" class="form-control bg-white border-left-0 border-md">
                    </div>

                    <!-- Time -->
                    <div class="input-group col-lg-6 mb-4">
                        <div class="input-group-prepend">
                            <span class="input-group-text bg-white px-4 border-md border-right-0">
                                <i class="fa fa-clock-o text-muted"></i>
                            </span>
                        </div>
                        <input id="consultTime" type="time" name="consultTime" placeholder="Time" class="form-control bg-white border-left-0 border-md">
                    </div>

                    <!-- Payment -->
                    <div class="input-group col-lg-12 mb-4">
                        <div class="input-group-prepend">
                            <span class="input-group-text bg-white px-4 border-md border-right-0">
                                <i class="fa fa-money text-muted"></i>
                            </span>
                        </div>
                        <input id="consultAmount" type="number" name="consultAmount" placeholder="Consultancy Cost" class="form-control bg-white border-left-0 border-md">
                    </div>

                     <!-- Payment -->
                    <div class="input-group col-lg-12 mb-4">
                        <input id="fn" type="hidden" name="consultAmount">
                    </div>

                    <!-- Submit Button -->
                    <div class="form-group col-lg-12 mx-auto mb-0">
                        <input type="submit" class="btn btn-primary btn-block py-2" value="Save">
                    </div>
                </div>
            </form>
            <p></p>
            <div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
                <h3 class="display-4">Consultation List</h3>
            </div>
            <!-- Patients Table -->
            <table id="tbl_consultList" class="table table-bordered table-striped table-sm">
                <thead class="thead-light">
                    <tr>
                        <td>ID</td>
                        <td>Patient Name</td>
                        <td>Doctor</td>
                        <td>Cost</td>
                        <td>Actions</td>
                    </tr>
                </thead>
                <tbody>
                    <% if (Object.keys(data).length > 0) { 
                        data.forEach(function(p){%>
                        <tr>
                            <td><%=p._id %></td>
                            <td><%=p.patientName%></td>
                            <td><%=p.doctor %></td>
                            <td><%=p.consultAmount %></td>
                            <td>
                                <a href="/editConsult/?id=<%=p._id%>" >Edit</a>
                                <a href="/deleteConsult/?id=<%=p._id%>">Delete</a>
                            </td>
                        </tr>

                <% })} else { %>
                    <tr>
                        <td colspan="6">No Record Found</td>
                    </tr> 
                <% } %>
                </tbody>
            </table>
      <footer class="pt-4 my-md-5 pt-md-5 border-top">
                <div class="row">
                <div class="col-12 col-md">
                    <small class="d-block mb-3 text-muted">Good Health Consult &copy; 2020</small>
                </div>
                </div>
            </footer>
    </div>
     <script>
        $(document).ready(function(){
            $("#patient").change(function(){
                alert($("#patient option:selected").text())
            })
            $("#patientName").select2({
                
            })
            $('#tbl_consultList').DataTable({
                "columnDefs": [{ "visible": false, "targets": 0 }]
            })

            $("#patient").
        });
    </script>
  </body>